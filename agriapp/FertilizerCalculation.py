crops = {
    "rice_or_paddy": {
        "frequency": "Quarterly",
        "npk": ["100:60:60"],
        "target_yield": ["18-19 Quintals per acre"],
    },
    "wheat": {
        "frequency": "Annual",
        "npk": ["40:30:20"],
        "target_yield": ["10 to 15 Quintals per acre"],
    },
    "jowar": {
        "frequency": "Annual",
        "npk": [],
        "target_yield": [""],
    },
    "bajra": {
        "frequency": "Annual",
        "npk": [],
        "target_yield": [""],
    },
    "ginger": {
        "frequency": "Annual",
        "npk": ["40:20:20"],
        "target_yield": ["15-20 tons per acre"],
    },
    "tomato": {
        "frequency": "Annual",
        "npk": ["100:100:100"],
        # "npk": "hybrid- 100:100:100",
        "target_yield": ["24 - 30 tons per acre"],
    },
    "tomato_improved_varieties": {
        "frequency": "Annual",
        "npk": ["46:40:24"],
        "target_yield": ["10-12 tons per acre"],
    },
    "garlic": {
        "frequency": "Annual",
        "npk": ["50:25:25"],
        "target_yield": ["3.2 tons per acre"],
    },
    "urad": {
        "frequency": "Annual",
        "npk": ["10:20:10"],
        "target_yield": ["4-7 Quintals per acre"],
    },
    "chilli": {
        "npk": ["60:30:30"],
        "target_yield": ["Green chilli- 14 to 16 ton per acre", "Red Chilli- 1.4 to 1.6 ton per acre"],
        "frequency": "Half"
    },
    "cotton": {
        "npk": ["60:30:30"],
        "target_yield": ["Black Soil- 7 to 8 Quintals per acre", "Sandy Soil- 5 to 6 Quintls per acre"],
        "frequency": "Annual"
    },
    "chana": {
        "npk": ["10:20:20"],
        "target_yield": ["6 to 8 Quintals per acre"],
        "frequency": "Quartely"
    },
    "sunflower": {
        "npk": ["36:36:25"],
        "target_yield": ["8 to 10 Quintasl per acre"],
        "frequency": "Annual"
    },
    "onion": {
        "npk": ["15:30:50"],
        "target_yield": ["8 to 10 tonns per acre"],
        "frequency": "Annual"
    },
    "moong": {
        "npk": ["10:20:20"],
        "target_yield": ["4 to 5 Quintals/acre"],
        "frequency": "Annual"
    },
    "masoori": {
        "npk": ["10:20:10"],
        "target_yield": ["5 to 6 Quintal/acre"],
        "frequency": "Annual"
    },
    "ragi": {
        "npk": ["40:20:20"],
        "target_yield": ["12 to 18 Quintals per acre"],
        "frequency": "Annual"
    },
    "sugarcane": {
        "npk": ["100:40:50"],
        "target_yield": ["60 to 70 tonns per acre"],
        "frequency": "Annual"
    },
    "arabica_coffee": {
        "npk": ["15:24:12", "20:30:15", "30:47:23", "56:36:56", "64:48:64"],
        "duration": ["1st year", "2nd year", "3rd year", "4th year", "5th year"],
        # "npk": "1st year-15:24:12\n2nd year-20:30:15\n3rd year-30:47:23\n4th year- 56:36:56\n5th year-64:48:64",
        "target_yield": ["800 tonns per acre"],
        "frequency": "Annual"
    },
    "maize": {
        "npk": ["40:30:16", "60:30:15"],
        "duration": ["Dry land", "Irrigated"],
        # "npk": "Dry land-40:30:16\nIrrigated 60:30:15",
        "target_yield": ["32- 35 tonns per acre", "30-33 tonns per acre"],
        "frequency": "Annual"
    },
    "groundnut": {
        "npk": ["10:30:15"],
        "target_yield": ["8 to 10 tonns per acre"],
        "frequency": "Annual"
    },
    "sesame": {
        "npk": ["15:10:10"],
        "target_yield": ["1.6 to 2 tonns per acre"],
        "frequency": "Annual"
    },
    "arecanut": {
        "npk": ["100:42:20"],
        "target_yield": ["500 to 600 kg per acre"],
        "frequency": "Annual"
    },
    "rubber": {
        "npk": ["25:25:10", "90:90:40", "110:110:50", "90:90:40", "140: 90:60"],
        "duration": ["1st year gm per tree", "2nd year gm per tree", "3rd year gm per tree", "4th year gm per tree", "5th year"],
        # "npk": "1st year-25:25:10 gm per tree, 2nd year- 90:90:40 gm per tree, 3rd year- 110:110:50 gm per tree, 4th year- 90:90:40 gm per tree, 5th year- 140: 90:60",
        "target_yield": ["300-400 kg/acre"],
        "frequency": "Annual"
    },
    "banana": {
        "npk": ["260:130:270", "175:105:220", "160:96:200"],
        "duration": ["pache variety", "kandu variety", "other varieties"],
        # "npk": "pache variety- 260:130:270, kandu variety- 175:105:220, other varieties- 160:96:200",
        "target_yield": ["8-12 tonns per acre for pache variety", "12-14 tonns per acre for kandu variety", "12-16 tonns per acre for other varieties"],
        "frequency": "Annual"
    },
    "cow_pea_or_aldisandi": {
        "npk": ["10:20:10"],
        "target_yield": ["5 to 6 Quintals per acre"],
        "frequency": "Annual"
    },
    "kusume_or_safflower": {
        "npk":[ "16:16:05"],
        "target_yield": ["4 to 5 Quintals per acre"],
        "frequency": "Annual"
    },
    "soyabean": {
        "npk": ["12:32:15"],
        "target_yield": ["10-12 Quintals per acre"],
        "frequency": "Annual"
    },
    "castor": {
        "npk": ["15:15:10"],
        "target_yield": ["Hybrids-5 to 7 Quintals per acre", "Improved varities-4 to 5 Quintal per acre"],
        "frequency": "Annual"
    },
    "coriander": {
        "npk": ["14:14:14"],
        "target_yield": ["Seed- 200 to 300 Kg per acre", "plant- 3.4 to 4 tonns per acre"],
        "frequency": "Annual"
    },
    "turmeric": {
        "npk": ["60:51:40"],
        "target_yield":[ "8 to 10 tonns per acre"],
        "frequency": "Annual"
    }
}


def calculate_fertilizer_doses(npk_recommended, kg):
    # Assume the npk_recommended value is in the format of "120:60:60"
    n, p, k = map(int, npk_recommended.split(":"))

    # Constants
    # MOP_recommended = 60
    DAP_p2o5 = 46
    DAP_n    = 18
    UREA_n   = 46

    # Calculate the DAP doses
    p2o5_required = p
    dap_dose = (p2o5_required / DAP_p2o5) * kg
    dap_n_supplied = (dap_dose / kg) * DAP_n

    # Calculate the Urea doses
    urea_n_required = n - dap_n_supplied
    urea_dose = (urea_n_required / UREA_n) * kg

    # Calculate the MOP doses
    mop_dose = (k/60) * kg

    # Calculate the SSP doses
    ssp_dose = (p/16) * kg

    round(mop_dose, 2)

    return round(mop_dose, 2), convert_to_acre(mop_dose), round(dap_dose, 2), convert_to_acre(dap_dose), round(urea_dose, 2), convert_to_acre(urea_dose), round(ssp_dose, 2), convert_to_acre(ssp_dose),


def convert_to_acre(hectre_value):
    return round(hectre_value/2.5, 2)


def calc_soil_parameters(pH, EC, OC):
    if pH < 6.5 and EC < 4:
        remedy = "Apply lime"
    elif pH > 7.7 and 8.5 > EC:
        remedy = "Remove salts with leaching and drainage"
    elif pH > 8.5 and EC < 4:
        remedy = "Gypsum application required"
    else:
        remedy = "No remedy needed"

    if OC < 0.5:
        fertility = "Low fertile, recommend green manure"
    elif 0.5 <= OC < 0.75:
        fertility = "Medium fertile, soil is fertile"
    else:
        fertility = "High fertile, soil is fertile"

    return remedy, fertility


def calc_fymanure(crop_type):
    if crop_type == "Kharif and Rabi":
        fym = 25
    else:
        fym = 10

    return fym


''' case 1 

if n or p or k value is missing then get npk from crop name dict above


case 2

N P AND k valuer are proper
incoming values in hector

-- n --
n < 250 
n = n + (25% * n)

n_dict = 60

n_input < 250 :
  n = n_dict + (25% * n_dict)
            60 + (25% * 60)

n_input (250-560):
    n = n_dict

n_input > 560):
    n = n_dict - (25% * n_dict)



-- p --

p_input < 22:
    p = p_dict - (25% * p_dict)

p_input (22-56):
    p = p_dict

p_input > 56:
    p = p_dict - (25% * p_dict)


-- k --

k_input < 141:
    p
    k = k_dict - (25% * k_dict)

k_input (141-336):
    k = k_dict

k_input > 336:
    k = k_dict - (25% * k_dict)


'''

crop_type = "Annual crops" # form API

npk_recommended = "30:60:30" # from API
kg = 100

mop_dose, mop_in_hec, dap_dose, dap_in_hec, urea_dose, urea_in_hec, ssp_dose, ssp_in_hec = calculate_fertilizer_doses(
    npk_recommended, kg)

# from API
pH = 7.2
EC = 3.8
OC = 0.6

remedy, fertility = calc_soil_parameters(pH, EC, OC)
fym               = calc_fymanure(crop_type)

print("The recommended doses of fertilizer are:")
print("Urea:", urea_dose, "kg/hectare", urea_in_hec, "kg/acre")
print("DAP:", dap_dose, "kg/hectare", dap_in_hec, "kg/acre")
print("MOP:", mop_dose, "kg/hectare", mop_in_hec, "kg/acre")
print("SSP:", ssp_dose, "kg/hectare", ssp_in_hec, "kg/acre")


print(f"Soil remedy: {remedy}")
print(f"Soil fertility: {fertility}")
print(f"FYM: {fym} tons/hectare")
print("Crop target yeild given in object : target yield from the dict for given crop in API")

def get_All_crops(n, p, k, crop):
    if crop in crops: # check if crop is valid
        n_p_k = []
        if not n or not p or not k: # if any one of the parms are not present the fetch values from the crops table
            if crop in crops:
                crop_n_p_ks = crops[crop]['npk']
                for values in crop_n_p_ks:
                    v = values.split(':')
                    n_p_k.append({'n' : v[0], 'p' : v[1], 'k' : v[2]})
        else:
            n_p_k.append({'n' : n, 'p' : p, 'k' : k})
    print(n_p_k,'------------')
    mop_dose, mop_in_hec, dap_dose, dap_in_hec, urea_dose, urea_in_hec, ssp_dose, ssp_in_hec = calculate_fertilizer_doses(
    npk_recommended, kg)

    print("The recommended doses of fertilizer are:")
    print("Urea:", urea_dose, "kg/hectare", urea_in_hec, "kg/acre")
    print("DAP:", dap_dose, "kg/hectare", dap_in_hec, "kg/acre")
    print("MOP:", mop_dose, "kg/hectare", mop_in_hec, "kg/acre")
    print("SSP:", ssp_dose, "kg/hectare", ssp_in_hec, "kg/acre")


    return crops.keys()